Представленный код иллюстрирует реализацию GraphQL сервера, использующего библиотеку graphql-yoga и axios для взаимодействия с микросервисами. Сервер обрабатывает запросы GraphQL, делегируя их выполнение соответствующим микросервисам через HTTP-запросы.

Схема GraphQL (typeDefs) определяет типы данных, представляющие сущности приложения: Restaurant, MenuItem, Order, User, Courier, Review, RestaurantReview, CourierReview, RestaurantAddress и DeliveryAddress. Схема включает в себя скалярные типы (ID, String, Float, Boolean), типы-объекты, перечисление (OrderStatus) и интерфейсы (Review). Определение типов данных включает поля, которые описывают атрибуты каждой сущности, такие как id, name, cuisine, price, status, street, и т.д. Схема содержит определения типов RestaurantReview и CourierReview, которые реализуют интерфейс Review, демонстрируя использование интерфейсов в GraphQL для определения общих свойств.

Резолверы определяют логику обработки запросов к каждому полю в схеме. Каждый резолвер Query делает HTTP-запрос к соответствующему микросервису с помощью axios.get. Например, резолвер restaurants выполняет GET запрос к http://restaurant-service/restaurants, используя параметр cuisine из запроса GraphQL. В случае успешного запроса, данные возвращаются клиенту. Блок try...catch обрабатывает потенциальные ошибки при выполнении HTTP запроса, возвращая пустой массив или null в случае возникновения ошибок. Это обеспечивает более надежную работу сервера.

Резолверы для связанных полей (например, Restaurant.menu, Order.restaurant, Order.user, Review.user, RestaurantReview.restaurant, CourierReview.courier) также используют axios.get для получения данных из соответствующих микросервисов на основе id родительского объекта. Это обеспечивает правильное разрешение данных из разных микросервисов. В каждом резолвэре предусмотрена обработка ошибок (try...catch), что улучшает стабильность. Обратите внимание на обработку случая, когда поле courier в Order может быть null.
Формирование URL в резолвере reviews осуществляется с помощью URLSearchParams, что гарантирует корректное кодирование параметров запроса
